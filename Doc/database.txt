CREATE DATABASE WECHAT16421;
Use WECHAT16421;

CREATE TABLE User(id BIGINT NOT NULL AUTO_INCREMENT,PRIMARY KEY  (id), WeChatUserid VARCHAR(50),AppUser VARCHAR(50), Password VARCHAR(20),Time DATETIME, Reporter VARCHAR(50), Name VARCHAR(50), Address VARCHAR(50), Mobile VARCHAR(20), Memo VARCHAR(50), State VARCHAR(20))ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE Message(id BIGINT NOT NULL AUTO_INCREMENT,PRIMARY KEY  (id), AppUser VARCHAR(50),Time DATETIME, Type VARCHAR(10), Confirmed VARCHAR(10), Piority VARCHAR(10), Title LONGTEXT, Content LONGTEXT)ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE GlobalMetaData(id INT NOT NULL AUTO_INCREMENT,PRIMARY KEY  (id), Name VARCHAR(50),Description VARCHAR(255), Type VARCHAR(50), Unit VARCHAR(50))ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE GlobalSettings(id INT NOT NULL AUTO_INCREMENT,PRIMARY KEY  (id), Name VARCHAR(50),Value VARCHAR(10), GlobalMetaid INT, FOREIGN KEY (GlobalMetaid) REFERENCES GlobalMetaData(id) ON DELETE CASCADE )ENGINE=InnoDB DEFAULT CHARSET=latin1;


CREATE TABLE Role(id INT NOT NULL AUTO_INCREMENT,PRIMARY KEY  (id), Name VARCHAR(50),Description VARCHAR(255))ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE Permission(id INT NOT NULL AUTO_INCREMENT,PRIMARY KEY  (id), Name VARCHAR(50),Description VARCHAR(255))ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE User_Role(id INT NOT NULL AUTO_INCREMENT,PRIMARY KEY  (id), Userid BIGINT,FOREIGN KEY (Userid) REFERENCES User(id) ON DELETE CASCADE, Roleid INT, FOREIGN KEY (Roleid) REFERENCES Role(id) ON DELETE CASCADE)ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE Role_Permission(id INT NOT NULL AUTO_INCREMENT,PRIMARY KEY  (id), Roleid INT, FOREIGN KEY (Roleid) REFERENCES Role(id) ON DELETE CASCADE, Permissionid INT, FOREIGN KEY (Permissionid) REFERENCES Permission(id) ON DELETE CASCADE)ENGINE=InnoDB DEFAULT CHARSET=latin1;